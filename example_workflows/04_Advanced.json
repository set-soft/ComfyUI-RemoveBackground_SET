{"id":"ab859718-fd36-4e96-8b3b-1e5266d310dd","revision":0,"last_node_id":52,"last_link_id":79,"nodes":[{"id":3,"type":"PreviewImage","pos":[2495.562255859375,335.789306640625],"size":[378.5118408203125,246.00001525878906],"flags":{},"order":24,"mode":0,"inputs":[{"label":"images","localized_name":"images","name":"images","type":"IMAGE","link":66}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.51","Node name for S&R":"PreviewImage","ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":[],"color":"#222","bgcolor":"#000"},{"id":4,"type":"MaskPreview","pos":[2499.08251953125,641.8138427734375],"size":[368.3013000488281,258],"flags":{},"order":26,"mode":0,"inputs":[{"localized_name":"mask","name":"mask","type":"MASK","link":67}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.51","Node name for S&R":"MaskPreview","ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":[],"color":"#222","bgcolor":"#000"},{"id":30,"type":"LoadImage","pos":[-799.6654663085938,468.06646728515625],"size":[274.080078125,314.0000305175781],"flags":{},"order":0,"mode":4,"inputs":[{"localized_name":"image","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"choose file to upload","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","links":[46]},{"localized_name":"MASK","name":"MASK","type":"MASK","links":[47]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.59","Node name for S&R":"LoadImage","ue_properties":{"version":"7.0.1","widget_ue_connectable":{"image":true,"upload":true}}},"widgets_values":["example.png","image"],"color":"#222","bgcolor":"#000"},{"id":11,"type":"MarkdownNote","pos":[2916.97314453125,643.109619140625],"size":[312.5177307128906,241.44107055664062],"flags":{},"order":1,"mode":0,"inputs":[],"outputs":[],"properties":{"ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":["# This is the mask where white is the foreground"],"color":"#432","bgcolor":"#653"},{"id":10,"type":"MarkdownNote","pos":[2915.4658203125,340.6580810546875],"size":[312.5177307128906,241.44107055664062],"flags":{},"order":2,"mode":0,"inputs":[],"outputs":[],"properties":{"ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":["# This is an RGB image\n"],"color":"#432","bgcolor":"#653"},{"id":1,"type":"AutoDownloadBiRefNetModel_SET","pos":[-488.0947265625,204.50823974609375],"size":[290.5611267089844,146],"flags":{},"order":3,"mode":0,"inputs":[{"localized_name":"model_name","name":"model_name","type":"COMBO","widget":{"name":"model_name"},"link":null},{"localized_name":"device","name":"device","type":"COMBO","widget":{"name":"device"},"link":null},{"localized_name":"dtype","name":"dtype","shape":7,"type":"COMBO","widget":{"name":"dtype"},"link":null}],"outputs":[{"localized_name":"model","name":"model","type":"SET_REMBG","links":[55]},{"localized_name":"train_w","name":"train_w","type":"INT","links":[48]},{"localized_name":"train_h","name":"train_h","type":"INT","links":[49]}],"properties":{"aux_id":"set-soft/ComfyUI_BiRefNet_SET","ver":"4a1884d296e39e36c3b6f4c873c08ac9e7ce1294","Node name for S&R":"AutoDownloadBiRefNetModel_SET","ue_properties":{"version":"7.0.1","widget_ue_connectable":{"model_name":true,"device":true,"dtype":true}}},"widgets_values":["General","AUTO","AUTO"],"color":"#2a363b","bgcolor":"#3f5159"},{"id":35,"type":"ResizeAndPadImage","pos":[-77.33975219726562,198.73716735839844],"size":[270,130],"flags":{},"order":12,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":51},{"localized_name":"target_width","name":"target_width","type":"INT","widget":{"name":"target_width"},"link":48},{"localized_name":"target_height","name":"target_height","type":"INT","widget":{"name":"target_height"},"link":49},{"localized_name":"padding_color","name":"padding_color","type":"COMBO","widget":{"name":"padding_color"},"link":null},{"localized_name":"interpolation","name":"interpolation","type":"COMBO","widget":{"name":"interpolation"},"link":null}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","links":[50,52]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.59","Node name for S&R":"ResizeAndPadImage","ue_properties":{"version":"7.0.1","widget_ue_connectable":{"target_width":true,"target_height":true,"padding_color":true,"interpolation":true}}},"widgets_values":[512,512,"black","lanczos"],"color":"#222","bgcolor":"#000"},{"id":37,"type":"SET_NormalizeToImageNetDataset","pos":[288.1811828613281,195.465576171875],"size":[225.86483764648438,26],"flags":{},"order":15,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":52}],"outputs":[{"localized_name":"image","name":"image","type":"IMAGE","links":[56]}],"properties":{"cnr_id":"image-misc","ver":"0d3c321ae3a652184eafbf455521ea0890476e6e","Node name for S&R":"SET_NormalizeToImageNetDataset","ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":[],"color":"#2a363b","bgcolor":"#3f5159"},{"id":34,"type":"GetMaskLowByBiRefNet_SET","pos":[611.5174560546875,175.32884216308594],"size":[303.6714782714844,78],"flags":{},"order":16,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"SET_REMBG","link":55},{"localized_name":"images","name":"images","type":"IMAGE","link":56},{"localized_name":"batched","name":"batched","type":"BOOLEAN","widget":{"name":"batched"},"link":null}],"outputs":[{"localized_name":"mask","name":"mask","type":"MASK","links":[59]}],"properties":{"aux_id":"set-soft/ComfyUI_BiRefNet_SET","ver":"450fdf2cb5ccb7f95a82bd9178033dc58a9d7dbc","Node name for S&R":"GetMaskLowByBiRefNet_SET","ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":[true],"color":"#2a363b","bgcolor":"#3f5159"},{"id":40,"type":"ImageToMask","pos":[1543.6162109375,177.02699279785156],"size":[270,58],"flags":{},"order":21,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":77},{"localized_name":"channel","name":"channel","type":"COMBO","widget":{"name":"channel"},"link":null}],"outputs":[{"localized_name":"MASK","name":"MASK","type":"MASK","links":[64]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.57","Node name for S&R":"ImageToMask","ue_properties":{"version":"7.0.1","widget_ue_connectable":{"channel":true}}},"widgets_values":["red"],"color":"#232","bgcolor":"#353"},{"id":6,"type":"SaveImage","pos":[2504.229736328125,4.169667720794678],"size":[363.5760803222656,282],"flags":{},"order":23,"mode":4,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":65},{"localized_name":"filename_prefix","name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":null}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.59","Node name for S&R":"SaveImage","ue_properties":{"version":"7.0.1","widget_ue_connectable":{"filename_prefix":true}}},"widgets_values":["BiRefNet"],"color":"#222","bgcolor":"#000"},{"id":42,"type":"SET_ApplyMaskAFFCE","pos":[1947.6644287109375,155.1544189453125],"size":[270,174],"flags":{},"order":22,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":63},{"localized_name":"masks","name":"masks","type":"MASK","link":64},{"localized_name":"blur_size","name":"blur_size","type":"INT","widget":{"name":"blur_size"},"link":null},{"localized_name":"blur_size_two","name":"blur_size_two","type":"INT","widget":{"name":"blur_size_two"},"link":null},{"localized_name":"fill_color","name":"fill_color","type":"BOOLEAN","widget":{"name":"fill_color"},"link":null},{"localized_name":"color","name":"color","type":"STRING","widget":{"name":"color"},"link":null},{"localized_name":"batched","name":"batched","type":"BOOLEAN","widget":{"name":"batched"},"link":null}],"outputs":[{"localized_name":"image","name":"image","type":"IMAGE","links":[65,66,79]},{"localized_name":"mask","name":"mask","type":"MASK","links":[67]}],"properties":{"cnr_id":"image-misc","ver":"01945ade869671e725a984f2da615e0be376da66","Node name for S&R":"SET_ApplyMaskAFFCE","ue_properties":{"version":"7.0.1","widget_ue_connectable":{"blur_size":true,"blur_size_two":true,"fill_color":true,"color":true}}},"widgets_values":[90,6,true,"#000000",true],"color":"#323","bgcolor":"#535"},{"id":14,"type":"SET_ImageDownload","pos":[-481.0677185058594,467.77496337890625],"size":[270,338],"flags":{},"order":11,"mode":0,"inputs":[{"localized_name":"image_bypass","name":"image_bypass","shape":7,"type":"IMAGE","link":46},{"localized_name":"mask_bypass","name":"mask_bypass","shape":7,"type":"MASK","link":47},{"localized_name":"base_url","name":"base_url","type":"STRING","widget":{"name":"base_url"},"link":null},{"localized_name":"filename","name":"filename","type":"STRING","widget":{"name":"filename"},"link":null},{"localized_name":"local_name","name":"local_name","shape":7,"type":"STRING","widget":{"name":"local_name"},"link":null}],"outputs":[{"localized_name":"image","name":"image","type":"IMAGE","links":[51,62,63,78]},{"localized_name":"alpha_mask","name":"alpha_mask","type":"MASK","links":[]}],"properties":{"cnr_id":"image-misc","ver":"3ab5664ee7057737c3215db19b078afbcead7a08","Node name for S&R":"SET_ImageDownload","aux_id":"set-soft/ComfyUI-ImageMisc","ue_properties":{"version":"7.0.1","widget_ue_connectable":{"base_url":true,"filename":true}}},"widgets_values":["https://www.birefnet.top/PictureBox","1.jpg","birefnet_1.jpg"],"color":"#2a363b","bgcolor":"#3f5159"},{"id":38,"type":"MaskToImage","pos":[1026.655517578125,175.70306396484375],"size":[184.62362670898438,26],"flags":{},"order":17,"mode":0,"inputs":[{"localized_name":"mask","name":"mask","type":"MASK","link":59}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","links":[68,76]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.57","Node name for S&R":"MaskToImage","ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":[],"color":"#232","bgcolor":"#353"},{"id":46,"type":"ImageScale","pos":[1244.8226318359375,179.42840576171875],"size":[270,130],"flags":{},"order":19,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":76},{"localized_name":"upscale_method","name":"upscale_method","type":"COMBO","widget":{"name":"upscale_method"},"link":null},{"localized_name":"width","name":"width","type":"INT","widget":{"name":"width"},"link":73},{"localized_name":"height","name":"height","type":"INT","widget":{"name":"height"},"link":74},{"localized_name":"crop","name":"crop","type":"COMBO","widget":{"name":"crop"},"link":null}],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","links":[75,77]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.59","Node name for S&R":"ImageScale","ue_properties":{"version":"7.0.1","widget_ue_connectable":{"upscale_method":true,"width":true,"height":true,"crop":true}}},"widgets_values":["bicubic",512,512,"center"],"color":"#232","bgcolor":"#353"},{"id":44,"type":"PreviewImage","pos":[1568.6966552734375,-176.76846313476562],"size":[217.86000061035156,258],"flags":{},"order":20,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":75}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.59","Node name for S&R":"PreviewImage","ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":[],"color":"#432","bgcolor":"#653"},{"id":41,"type":"GetImageSize","pos":[980.0958862304688,247.29345703125],"size":[241.87786865234375,161.0735626220703],"flags":{},"order":13,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":62}],"outputs":[{"localized_name":"width","name":"width","type":"INT","links":[73]},{"localized_name":"height","name":"height","type":"INT","links":[74]},{"localized_name":"batch_size","name":"batch_size","type":"INT","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.57","Node name for S&R":"GetImageSize","ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":[],"color":"#232","bgcolor":"#353"},{"id":12,"type":"MarkdownNote","pos":[2912.6103515625,9.453972816467285],"size":[312.5177307128906,241.44107055664062],"flags":{},"order":4,"mode":0,"inputs":[],"outputs":[],"properties":{"ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":["# Enable this node to save the image"],"color":"#432","bgcolor":"#653"},{"id":31,"type":"MarkdownNote","pos":[-764.132080078125,0.47993022203445435],"size":[561.5595092773438,132.5689239501953],"flags":{},"order":5,"mode":0,"inputs":[],"outputs":[],"properties":{"ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":["# This workflow shows how to do a custom pre and post processing of the image/mask\n"],"color":"#432","bgcolor":"#653"},{"id":36,"type":"PreviewImage","pos":[274.702392578125,-145.4186248779297],"size":[251.77528381347656,246],"flags":{"collapsed":false},"order":14,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":50}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.59","Node name for S&R":"PreviewImage","ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":[],"color":"#432","bgcolor":"#653"},{"id":48,"type":"MarkdownNote","pos":[271.21820068359375,276.0028991699219],"size":[274.0300598144531,111.83796691894531],"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[],"properties":{"ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":["## We normalize the image to the ImageNet stats\n## The model was trained this way"],"color":"#432","bgcolor":"#653"},{"id":49,"type":"MarkdownNote","pos":[616.4337768554688,0.19090169668197632],"size":[274.0300598144531,111.83796691894531],"flags":{},"order":7,"mode":0,"inputs":[],"outputs":[],"properties":{"ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":["## Model is applied here to get a mask"],"color":"#432","bgcolor":"#653"},{"id":50,"type":"MarkdownNote","pos":[976.9722290039062,462.58160400390625],"size":[439.8778381347656,103.7258529663086],"flags":{},"order":8,"mode":0,"inputs":[],"outputs":[],"properties":{"ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":["## Here we upscale the mask to the image size\n\n## Note that we convert the mask to an image just because ComfyUI lacks mask operations. KiJai nodes have it."],"color":"#432","bgcolor":"#653"},{"id":51,"type":"MarkdownNote","pos":[1946.9761962890625,360.4512939453125],"size":[274.0300598144531,111.83796691894531],"flags":{},"order":9,"mode":0,"inputs":[],"outputs":[],"properties":{"ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":["## Here the mask is applied using a fast foreground estimation"],"color":"#432","bgcolor":"#653"},{"id":43,"type":"PreviewImage","pos":[1280.6497802734375,-178.927978515625],"size":[217.86000061035156,258],"flags":{},"order":18,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":68}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.59","Node name for S&R":"PreviewImage","ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":[],"color":"#432","bgcolor":"#653"},{"id":52,"type":"Image Comparer (rgthree)","pos":[871.0328979492188,724.9498901367188],"size":[1150.37158203125,855.044921875],"flags":{},"order":25,"mode":0,"inputs":[{"dir":3,"name":"image_a","type":"IMAGE","link":79},{"dir":3,"name":"image_b","type":"IMAGE","link":78}],"outputs":[],"properties":{"cnr_id":"rgthree-comfy","ver":"1.0.2508192121","comparer_mode":"Slide","ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":[[{"name":"A","selected":true,"url":"/api/view?filename=rgthree.compare._temp_bclbf_00001_.png&type=temp&subfolder=&rand=0.9738823643798942"},{"name":"B","selected":true,"url":"/api/view?filename=rgthree.compare._temp_bclbf_00002_.png&type=temp&subfolder=&rand=0.4399262001161883"}]],"color":"#432","bgcolor":"#653"},{"id":47,"type":"MarkdownNote","pos":[-80.70278930664062,370.9444885253906],"size":[344.0520324707031,206.44210815429688],"flags":{},"order":10,"mode":0,"inputs":[],"outputs":[],"properties":{"ue_properties":{"version":"7.0.1","widget_ue_connectable":{}}},"widgets_values":["## Here we resize the image, but keeping the aspect ratio\n## This is done adding black areas\n## Note that scaling to the trained model isn't mandatory.  But the size must be a multiple of 32."],"color":"#432","bgcolor":"#653"}],"links":[[46,30,0,14,0,"IMAGE"],[47,30,1,14,1,"MASK"],[48,1,1,35,1,"INT"],[49,1,2,35,2,"INT"],[50,35,0,36,0,"IMAGE"],[51,14,0,35,0,"IMAGE"],[52,35,0,37,0,"IMAGE"],[55,1,0,34,0,"BIREFNET"],[56,37,0,34,1,"IMAGE"],[59,34,0,38,0,"MASK"],[62,14,0,41,0,"IMAGE"],[63,14,0,42,0,"IMAGE"],[64,40,0,42,1,"MASK"],[65,42,0,6,0,"IMAGE"],[66,42,0,3,0,"IMAGE"],[67,42,1,4,0,"MASK"],[68,38,0,43,0,"IMAGE"],[73,41,0,46,2,"INT"],[74,41,1,46,3,"INT"],[75,46,0,44,0,"IMAGE"],[76,38,0,46,0,"IMAGE"],[77,46,0,40,0,"IMAGE"],[78,14,0,52,1,"IMAGE"],[79,42,0,52,0,"IMAGE"]],"groups":[{"id":1,"title":"Resize mask to image size","bounding":[970.0958862304688,102.10306549072266,849.561279296875,313.6246337890625],"color":"#3f789e","font_size":24,"flags":{}}],"config":{},"extra":{"ue_links":[],"ds":{"scale":1.491595776779668,"offset":[483.0911465523835,-130.12059953921207]},"links_added_by_ue":[],"reroutes":[{"id":2,"pos":[-108.62671661376953,139.73500061035156],"linkIds":[55]},{"id":3,"parentId":2,"pos":[535.2720947265625,140.9296875],"linkIds":[55]},{"id":4,"parentId":9,"pos":[660.7029418945312,629.025390625],"linkIds":[62,63,78]},{"id":5,"parentId":4,"pos":[1863.27587890625,628.8262329101562],"linkIds":[63]},{"id":6,"pos":[2309.374267578125,168.04844665527344],"linkIds":[65,66,79]},{"id":7,"parentId":6,"pos":[2259.494873046875,650.227294921875],"linkIds":[79]},{"id":8,"parentId":7,"pos":[815.2132568359375,668.78662109375],"linkIds":[79]},{"id":9,"pos":[-106.55693054199219,625.9456787109375],"linkIds":[62,63,78]}],"linkExtensions":[{"id":55,"parentId":3},{"id":62,"parentId":4},{"id":63,"parentId":5},{"id":65,"parentId":6},{"id":66,"parentId":6},{"id":78,"parentId":4},{"id":79,"parentId":8}]},"version":0.4}